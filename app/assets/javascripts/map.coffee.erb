# Constants
mapOptions = {
  zoom: 5,
  center: {lat: 38.6, lng: -95.7},
  mapTypeId: 'terrain'
}
lineSymbol = {
  path: 'M 0,-.2 0,.2'
  strokeOpacity: 1
  scale: 5
};

# Document Ready
$(
  ->
    # Setup
    mapContainer = document.getElementById("map-container")
    return if !mapContainer
    map = new google.maps.Map(mapContainer, mapOptions)
    directionsService = new google.maps.DirectionsService
    # Draw Route Method
    drawRoute = (options) ->
      directionsDisplay = new google.maps.DirectionsRenderer({
        map: map
        preserveViewport: true
        suppressMarkers: true
        polylineOptions: {
          strokeColor: options.color || "blue"
          strokeOpacity: 0
          icons: [{
            icon: lineSymbol
            offset: '0'
            repeat: '15px'
          }]
        }
      })
      request = {
        origin: options.origin
        destination: options.destination
        waypoints: options.waypoints || []
        travelMode: google.maps.DirectionsTravelMode.DRIVING
      }
      directionsService.route(request, (response) -> directionsDisplay.setDirections(response) )
    # Place Marker Method
    placeMarker = (options) ->
      new google.maps.Marker({
        position: { lat: options.lat, lng: options.lng }
        map: map
      });
    # Draw routes, place markers
    helga.routes.forEach(drawRoute)
    helga.geoPoints.forEach(placeMarker)
)
